---
title:   Document java software with "R CMD build", ant, and javadoc
author: "Romain Fran√ßois"
date:  2009-03-27
slug:  Document-java-software-with--R-CMD-build---ant--and-javadoc
tags:  [ "ant", "java", "javadoc", "R" ]
---
<div class="post-content">
<style>
pre{
border: 1px solid black;
font-size: xx-small !important ;
}
</style>
<p>This is the sequel of this <a href="/index.php?post/2009/03/26/Hello-Java-World">post</a> where we look at ways to build javadoc documentation as part of an R package</p>

<p>Ant has the <a href="http://ant.apache.org/manual/CoreTasks/javadoc.html">javadoc</a> task which we will use to build html files from java sources, leading to this modified build script with the new <em>javadoc</em> target: </p>

<pre><font color="#000000"><span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   1 </font></span><font color="#0000ff">&lt;</font><font color="#0000ff">project</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">Hello</font><font color="#ff00cc"> </font><font color="#ff00cc">Java</font><font color="#ff00cc"> </font><font color="#ff00cc">World</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">basedir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">.</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">default</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">build</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   2 </font></span>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   3 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">property</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">target.dir</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">value</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">../inst/java</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   4 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">property</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">javadoc.dir</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">value</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">../inst/javadoc</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">   5 </font></span>  
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   6 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">target</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">clean</font><font color="#ff00cc">"</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   7 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">delete</font><font color="#0000ff"> </font><font color="#0000ff">dir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">bin</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   8 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">delete</font><font color="#0000ff"> </font><font color="#0000ff">dir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">${javadoc.dir}</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">   9 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">target</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  10 </font></span>  
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  11 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">target</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">compile</font><font color="#ff00cc">"</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  12 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">mkdir</font><font color="#0000ff"> </font><font color="#0000ff">dir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">bin</font><font color="#ff00cc">"</font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  13 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">javac</font><font color="#0000ff"> </font><font color="#0000ff">srcdir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">src</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">destdir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">bin</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  14 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">target</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  15 </font></span>  
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  16 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">target</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">javadoc</font><font color="#ff00cc">"</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  17 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">mkdir</font><font color="#0000ff"> </font><font color="#0000ff">dir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">${javadoc.dir}</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  18 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">javadoc</font><font color="#0000ff"> </font><font color="#0000ff">access</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">public</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">destdir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">${javadoc.dir}</font><font color="#ff00cc">"</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  19 </font></span><font color="#0000ff"> </font><font color="#0000ff"> </font><font color="#0000ff"> </font><font color="#0000ff"> </font><font color="#0000ff"> </font><font color="#0000ff"> </font><font color="#0000ff">author</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">true</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">version</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">true</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">use</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">true</font><font color="#ff00cc">"</font><font color="#0000ff"> </font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  20 </font></span><font color="#0000ff">  </font><font color="#0000ff">  </font><font color="#0000ff">  </font><font color="#0000ff">windowtitle</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">helloJavaWorld</font><font color="#ff00cc"> </font><font color="#ff00cc">-</font><font color="#ff00cc"> </font><font color="#ff00cc">Java</font><font color="#ff00cc"> </font><font color="#ff00cc">API</font><font color="#ff00cc">"</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  21 </font></span>        
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  22 </font></span>       <font color="#0000ff">&lt;</font><font color="#0000ff">fileset</font><font color="#0000ff"> </font><font color="#0000ff">dir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">src</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">defaultexcludes</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">yes</font><font color="#ff00cc">"</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  23 </font></span>            <font color="#0000ff">&lt;</font><font color="#0000ff">include</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">**/*.java</font><font color="#ff00cc">"</font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  24 </font></span>        <font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">fileset</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  25 </font></span>          
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  26 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">javadoc</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  27 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">target</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  28 </font></span>  
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  29 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">target</font><font color="#0000ff"> </font><font color="#0000ff">name</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">build</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">depends</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">compile,javadoc</font><font color="#ff00cc">"</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  30 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">jar</font><font color="#0000ff"> </font><font color="#0000ff">jarfile</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">${target.dir}/hellojavaworld.jar</font><font color="#ff00cc">"</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  31 </font></span>      <font color="#0000ff">&lt;</font><font color="#0000ff">fileset</font><font color="#0000ff"> </font><font color="#0000ff">dir</font><font color="#0000ff">=</font><font color="#ff00cc">"</font><font color="#ff00cc">bin</font><font color="#ff00cc">"</font><font color="#0000ff"> </font><font color="#0000ff">/</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  32 </font></span>    <font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">jar</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  33 </font></span>  <font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">target</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  34 </font></span>  
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#990066">  35 </font></span><font color="#0000ff">&lt;</font><font color="#0000ff">/</font><font color="#0000ff">project</font><font color="#0000ff">&gt;</font>
<span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">  36 </font></span>
</font></pre>

<p>so that when we run "R CMD build", the directory inst/javadoc gets created and filled with documentation generated from the java sources</p>

<p>The next thing we need is a way to access this documentation from R documentation, so we will just add a link to it from the Rd file, I have added this into the <em>helloJavaWorld.Rd</em> file in the <em>seealso</em> section: </p>

<pre><font color="#000000"><span style="background:#dbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#000000">18 </font></span><font color="#006699"><strong>\seealso</strong></font><font color="#000000"><strong>{</strong></font><font color="#009966"><strong>\link</strong></font>[helloJavaWorld:../javadoc/index]<font color="#000000"><strong>{</strong></font>The Java API of the package<font color="#000000"><strong>}</strong></font><font color="#000000"><strong>}</strong></font>
</font></pre>

<p>This is not a perfect solution but gives a starting point. Potential issues, things to improve :</p>

<ul>
<li>It would be better to have a link in the <em>00Index.html</em> file, but there currently is no way to do something like that</li>
<li>A way to jump back to the R documentation from the java documentation is needed</li>
</ul>
<p>I have posted a copy of the built package <a href="http://addictedtor.free.fr/misc/tmp/helloJavaWorld/html/00Index.html">here</a>, and you can download the source of this version <a href="/public/posts/hellojavaworld/helloJavaWorld_0.0-8.tar.gz">here</a></p>

<p>Next step, use the <a href="http://ant.apache.org/manual/OptionalTasks/junitreport.html">junitreport ant task</a> to make a report of unit tests of the java code</p>
</div>
